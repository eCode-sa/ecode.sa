<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#FB4747">
    <title data-i18n="pageTitle">Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ | AndroGov</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.tailwindcss.com"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brandRed: '#FB4747',
                        brandBlue: '#4267B2',
                        brandDark: '#1E293B',
                        brandGray: '#F8FAFC'
                    },
                    fontFamily: {
                        sans: ['Tajawal', 'Inter', 'sans-serif'],
                        en: ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <style>
        /* âœ… Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { 
            background: #CBD5E1; 
            border-radius: 10px; 
        }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #94A3B8; }
        .dark .custom-scroll::-webkit-scrollbar-thumb { background: #475569; }
        .dark .custom-scroll::-webkit-scrollbar-thumb:hover { background: #64748B; }

        /* Number Font */
        .num-font { 
            font-family: 'Inter', sans-serif; 
            font-feature-settings: "tnum"; 
        }
        
        /* Glass Card Effect */
        .glass-card { 
            background: rgba(255, 255, 255, 0.9); 
            backdrop-filter: blur(10px); 
        }
        .dark .glass-card { 
            background: rgba(30, 41, 59, 0.9); 
        }
        
        /* âœ… Salary Privacy Blur Effect */
        .salary-blur { 
            filter: blur(5px); 
            transition: filter 0.3s ease; 
            user-select: none; 
        }
        .salary-container:hover .salary-blur { 
            filter: blur(0); 
        }
        .salary-overlay { 
            transition: opacity 0.3s ease; 
        }
        .salary-container:hover .salary-overlay { 
            opacity: 0; 
        }

        /* âœ… Loading Overlay */
        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(5px);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .dark .loading-overlay {
            background: rgba(15, 23, 42, 0.9);
        }
        .loading-overlay.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }
        
        /* âœ… Smooth Transitions */
        * {
            transition-property: background-color, border-color, color, fill, stroke, margin, padding;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 300ms;
        }
        
        /* âœ… Main Content Wrapper Transition */
        .main-content-wrapper {
            transition: margin-left 300ms ease, margin-right 300ms ease;
        }
        
        /* âœ… Sidebar Transition */
        #main-sidebar {
            transition: left 300ms ease, right 300ms ease, transform 300ms ease;
        }
    </style>
</head>
<body class="bg-brandGray dark:bg-slate-900 text-slate-800 dark:text-slate-100 font-sans">

    <!-- âœ… Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="relative">
            <div class="w-16 h-16 border-4 border-brandRed/20 border-t-brandRed rounded-full animate-spin"></div>
            <div class="absolute inset-0 w-16 h-16 border-4 border-transparent border-b-brandBlue rounded-full animate-spin" style="animation-direction: reverse; animation-duration: 0.8s;"></div>
        </div>
        <p class="text-sm font-bold text-slate-600 dark:text-slate-300 animate-pulse" data-i18n="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ...</p>
    </div>

    <!-- âœ… Sidebar Container -->
    <div id="sidebar-container"></div>
    
    <!-- âœ… Main Content Wrapper -->
    <div class="main-content-wrapper md:mr-72 transition-all duration-300 flex flex-col min-h-screen">
        
        <!-- âœ… Header Container -->
        <div id="header-container"></div>

        <main class="p-6 space-y-6">
            
            <!-- Profile Header Card -->
            <div class="bg-white dark:bg-slate-800 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden relative">
                <div class="h-32 bg-gradient-to-r from-brandRed to-red-700"></div>
                
                <div class="px-8 pb-8 flex flex-col md:flex-row items-end gap-6 -mt-12 relative">
                    <div class="w-32 h-32 rounded-3xl border-4 border-white dark:border-slate-800 shadow-lg overflow-hidden bg-white relative group">
                        <img id="profAvatar" src="" class="w-full h-full object-cover" onerror="this.src='https://ui-avatars.com/api/?name=User&background=random'">
                    </div>
                    
                    <div class="flex-1 mb-2">
                        <h1 class="text-3xl font-bold text-slate-900 dark:text-white flex items-center gap-2">
                            <span id="profName">...</span>
                            <i class="fa-solid fa-circle-check text-blue-500 text-lg" title="Verified"></i>
                        </h1>
                        <p class="text-slate-500 dark:text-slate-400 font-medium text-lg" id="profRole">...</p>
                        
                        <div class="flex flex-wrap gap-4 mt-4 text-xs font-mono text-slate-500 dark:text-slate-400">
                            <span class="flex items-center gap-1 bg-slate-100 dark:bg-slate-700 px-3 py-1 rounded-full">
                                <i class="fa-solid fa-id-badge text-brandRed"></i> 
                                ID: <span id="profId">...</span>
                            </span>
                            <span class="flex items-center gap-1 bg-slate-100 dark:bg-slate-700 px-3 py-1 rounded-full">
                                <i class="fa-solid fa-envelope text-brandRed"></i> 
                                <span id="profEmail">...</span>
                            </span>
                            <span class="flex items-center gap-1 bg-slate-100 dark:bg-slate-700 px-3 py-1 rounded-full">
                                <i class="fa-solid fa-building text-brandRed"></i> 
                                <span id="profDept">...</span>
                            </span>
                        </div>
                    </div>

                    <div class="flex gap-3 mb-2">
                        <button onclick="openRequestModal('leave')" class="px-5 py-2.5 bg-brandRed text-white rounded-xl text-sm font-bold shadow-lg shadow-red-500/30 hover:bg-red-700 hover:scale-105 transition flex items-center gap-2">
                            <i class="fa-solid fa-plane-departure"></i> 
                            <span data-i18n="reqLeave">Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø©</span>
                        </button>
                        <button onclick="openRequestModal('letter')" class="px-5 py-2.5 bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-xl text-sm font-bold hover:bg-slate-50 dark:hover:bg-slate-600 transition flex items-center gap-2">
                            <i class="fa-solid fa-file-contract"></i> 
                            <span data-i18n="reqLetter">ØªØ¹Ø±ÙŠÙ Ø±Ø§ØªØ¨</span>
                        </button>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- Left Column -->
                <div class="space-y-6">
                    
                    <!-- Leave Balance Card -->
                    <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg transition-shadow">
                        <h3 class="font-bold text-slate-800 dark:text-white mb-4 flex items-center gap-2">
                            <i class="fa-solid fa-umbrella-beach text-orange-500"></i> 
                            <span data-i18n="leaveBal">Ø±ØµÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª</span>
                        </h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="p-4 bg-green-50 dark:bg-green-900/10 rounded-2xl text-center border border-green-100 dark:border-green-900/30 hover:scale-105 transition-transform">
                                <p class="text-xs text-green-600 dark:text-green-400 font-bold mb-1" data-i18n="annual">Ø³Ù†ÙˆÙŠØ©</p>
                                <p class="text-3xl font-bold text-green-700 dark:text-green-500 num-font">26</p>
                                <p class="text-[10px] text-green-600/70 dark:text-green-500/70" data-i18n="days">ÙŠÙˆÙ…</p>
                            </div>
                            <div class="p-4 bg-blue-50 dark:bg-blue-900/10 rounded-2xl text-center border border-blue-100 dark:border-blue-900/30 hover:scale-105 transition-transform">
                                <p class="text-xs text-blue-600 dark:text-blue-400 font-bold mb-1" data-i18n="emergency">Ø§Ø¶Ø·Ø±Ø§Ø±ÙŠØ©</p>
                                <p class="text-3xl font-bold text-blue-700 dark:text-blue-500 num-font">3</p>
                                <p class="text-[10px] text-blue-600/70 dark:text-blue-500/70" data-i18n="days">Ø£ÙŠØ§Ù…</p>
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-slate-100 dark:border-slate-700">
                            <div class="flex justify-between text-xs mb-1 text-slate-500 dark:text-slate-400">
                                <span data-i18n="ticketEnt">Ø§Ø³ØªØ­Ù‚Ø§Ù‚ Ø§Ù„ØªØ°Ø§ÙƒØ±</span>
                                <span class="text-green-600 dark:text-green-400 font-bold" data-i18n="eligible">Ù…Ø³ØªØ­Ù‚ (Ø¹Ø§Ø¦Ù„Ø©)</span>
                            </div>
                            <div class="w-full bg-slate-100 dark:bg-slate-700 h-1.5 rounded-full overflow-hidden">
                                <div class="bg-gradient-to-r from-brandRed to-red-600 h-full w-[75%] transition-all duration-1000"></div>
                            </div>
                            <p class="text-[9px] text-right mt-1 text-slate-400">75%</p>
                        </div>
                    </div>

                    <!-- Contract Info Card -->
                    <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg transition-shadow">
                        <h3 class="font-bold text-slate-800 dark:text-white mb-4" data-i18n="contractInfo">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù‚Ø¯</h3>
                        <ul class="space-y-4 text-sm">
                            <li class="flex justify-between border-b border-slate-50 dark:border-slate-700 pb-2">
                                <span class="text-slate-500 dark:text-slate-400" data-i18n="joinDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©</span>
                                <span class="font-bold num-font dark:text-white">01-03-2019</span>
                            </li>
                            <li class="flex justify-between border-b border-slate-50 dark:border-slate-700 pb-2">
                                <span class="text-slate-500 dark:text-slate-400" data-i18n="contractType">Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø¯</span>
                                <span class="font-bold text-green-600 dark:text-green-400" data-i18n="unlimited">ØºÙŠØ± Ù…Ø­Ø¯Ø¯ Ø§Ù„Ù…Ø¯Ø©</span>
                            </li>
                            <li class="flex justify-between border-b border-slate-50 dark:border-slate-700 pb-2">
                                <span class="text-slate-500 dark:text-slate-400" data-i18n="manager">Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</span>
                                <span class="font-bold dark:text-white" data-i18n="ceoName">Ù‡Ø´Ø§Ù… Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠ (CEO)</span>
                            </li>
                            <li class="flex justify-between">
                                <span class="text-slate-500 dark:text-slate-400" data-i18n="location">Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…Ù„</span>
                                <span class="font-bold dark:text-white" data-i18n="hq">Ø§Ù„Ù…Ù‚Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ - Ø§Ù„Ø±ÙŠØ§Ø¶</span>
                            </li>
                        </ul>
                    </div>

                </div>

                <!-- Right Column (2 columns span) -->
                <div class="lg:col-span-2 space-y-6">
                    
                    <!-- Financial Data Card (with Privacy Blur) -->
                    <div class="bg-slate-900 dark:bg-slate-950 rounded-2xl p-6 text-white shadow-xl salary-container relative overflow-hidden group">
                        <div class="absolute top-0 right-0 p-4 opacity-50">
                            <i class="fa-solid fa-money-check-dollar text-6xl text-white/10"></i>
                        </div>
                        
                        <div class="flex justify-between items-center mb-6 relative z-10">
                            <h3 class="font-bold text-lg flex items-center gap-2">
                                <i class="fa-solid fa-lock text-brandRed"></i> 
                                <span data-i18n="financialData">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©</span>
                            </h3>
                            <span class="text-xs bg-white/20 px-2 py-1 rounded" data-i18n="confidential">Ø®Ø§Øµ ÙˆØ³Ø±ÙŠ</span>
                        </div>

                        <div class="grid grid-cols-2 md:grid-cols-4 gap-6 relative z-10">
                            <div>
                                <p class="text-xs text-slate-400 mb-1" data-i18n="basicSalary">Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</p>
                                <p class="text-xl font-bold font-mono salary-blur">6,274 SAR</p>
                            </div>
                            <div>
                                <p class="text-xs text-slate-400 mb-1" data-i18n="housing">Ø¨Ø¯Ù„ Ø³ÙƒÙ†</p>
                                <p class="text-xl font-bold font-mono salary-blur">1,569 SAR</p>
                            </div>
                            <div>
                                <p class="text-xs text-slate-400 mb-1" data-i18n="transport">Ø¨Ø¯Ù„ Ù†Ù‚Ù„</p>
                                <p class="text-xl font-bold font-mono salary-blur">627 SAR</p>
                            </div>
                            <div>
                                <p class="text-xs text-slate-400 mb-1" data-i18n="bonus">Ù…ÙƒØ§ÙØ¦Ø© Ø´Ù‡Ø±ÙŠØ©</p>
                                <p class="text-xl font-bold font-mono salary-blur">3,000 SAR</p>
                            </div>
                            <div class="border-r border-white/20 pr-4">
                                <p class="text-xs text-brandRed font-bold mb-1" data-i18n="netSalary">ØµØ§ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨</p>
                                <p class="text-2xl font-bold font-mono salary-blur text-brandRed">11,470 SAR</p>
                            </div>
                        </div>

                        <div class="absolute inset-0 flex items-center justify-center bg-slate-900/60 backdrop-blur-sm salary-overlay pointer-events-none">
                            <span class="bg-black/50 px-4 py-2 rounded-full text-xs font-bold flex items-center gap-2 border border-white/20">
                                <i class="fa-solid fa-eye"></i> 
                                <span data-i18n="hoverReveal">Ø¶Ø¹ Ø§Ù„Ù…Ø¤Ø´Ø± Ù„Ù„ÙƒØ´Ù</span>
                            </span>
                        </div>
                    </div>

                    <!-- Previous Requests Table -->
                    <div class="bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 overflow-hidden hover:shadow-lg transition-shadow">
                        <div class="p-6 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center">
                            <h3 class="font-bold text-slate-800 dark:text-white" data-i18n="prevReq">Ø·Ù„Ø¨Ø§ØªÙŠ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h3>
                            <button class="text-xs text-brandRed font-bold hover:underline" data-i18n="viewAll">Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„</button>
                        </div>
                        <table class="w-full text-sm">
                            <thead class="bg-slate-50 dark:bg-slate-700 text-slate-500 dark:text-slate-400 text-xs">
                                <tr>
                                    <th class="p-4 text-right" data-i18n="colReqNo">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
                                    <th class="p-4 text-right" data-i18n="colType">Ø§Ù„Ù†ÙˆØ¹</th>
                                    <th class="p-4 text-right" data-i18n="colDate">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨</th>
                                    <th class="p-4 text-right" data-i18n="colApp">Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª</th>
                                    <th class="p-4 text-center" data-i18n="colStatus">Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-slate-100 dark:divide-slate-700 dark:text-slate-300">
                                <tr class="hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors">
                                    <td class="p-4 font-mono text-xs">REQ-1022</td>
                                    <td class="p-4 font-bold" data-i18n="leave5days">Ø¥Ø¬Ø§Ø²Ø© Ø³Ù†ÙˆÙŠØ© (5 Ø£ÙŠØ§Ù…)</td>
                                    <td class="p-4 font-mono text-xs">2026-02-10</td>
                                    <td class="p-4 text-xs text-slate-500 dark:text-slate-400">Manager â†’ HR</td>
                                    <td class="p-4 text-center">
                                        <span class="bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-2 py-1 rounded text-[10px] font-bold" data-i18n="approved">Ù…Ø¹ØªÙ…Ø¯</span>
                                    </td>
                                </tr>
                                <tr class="hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors">
                                    <td class="p-4 font-mono text-xs">REQ-1045</td>
                                    <td class="p-4 font-bold" data-i18n="letterReq">Ø®Ø·Ø§Ø¨ ØªØ¹Ø±ÙŠÙ (Ø¨Ù†Ùƒ Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ)</td>
                                    <td class="p-4 font-mono text-xs">2026-03-01</td>
                                    <td class="p-4 text-xs text-slate-500 dark:text-slate-400">HR</td>
                                    <td class="p-4 text-center">
                                        <span class="bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 px-2 py-1 rounded text-[10px] font-bold" data-i18n="pending">ØªØ­Øª Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Attendance Record -->
                    <div class="bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 hover:shadow-lg transition-shadow">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-bold text-slate-800 dark:text-white" data-i18n="attendance">Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù (Ø£Ø³Ø¨ÙˆØ¹ÙŠ)</h3>
                            <span class="text-[10px] bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-2 py-1 rounded font-bold" data-i18n="discipline">Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù†Ø¶Ø¨Ø§Ø·: 98%</span>
                        </div>
                        <div class="grid grid-cols-5 gap-2 text-center" id="attendanceGrid">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                </div>
            </div>

        </main>
    </div>

    <!-- Request Modal -->
    <div id="requestModal" class="fixed inset-0 bg-black/60 hidden z-50 flex items-center justify-center backdrop-blur-sm p-4">
        <div class="bg-white dark:bg-slate-800 w-full max-w-lg rounded-2xl shadow-xl p-6 transform transition-all">
            <div class="flex justify-between items-center mb-6 border-b pb-4 dark:border-slate-700">
                <h3 class="font-bold text-lg dark:text-white" id="reqModalTitle" data-i18n="modTitle">Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
                <button onclick="document.getElementById('requestModal').classList.add('hidden')" class="hover:bg-slate-100 dark:hover:bg-slate-700 w-8 h-8 rounded-lg transition-colors">
                    <i class="fa-solid fa-xmark text-slate-400 text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 mb-1" data-i18n="modType">Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨</label>
                    <input type="text" id="reqType" class="w-full bg-slate-100 dark:bg-slate-700 border-none rounded-lg p-2 text-sm text-slate-500 dark:text-slate-300 cursor-not-allowed" readonly>
                </div>
                
                <div id="leaveFields" class="hidden space-y-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 mb-1" data-i18n="modFrom">Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                            <input type="date" class="w-full bg-white dark:bg-slate-900 border dark:border-slate-600 rounded-lg p-2 text-sm dark:text-white">
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 mb-1" data-i18n="modTo">Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                            <input type="date" class="w-full bg-white dark:bg-slate-900 border dark:border-slate-600 rounded-lg p-2 text-sm dark:text-white">
                        </div>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 mb-1" data-i18n="modLeaveType">Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©</label>
                        <select class="w-full bg-white dark:bg-slate-900 border dark:border-slate-600 rounded-lg p-2 text-sm dark:text-white">
                            <option data-i18n="annualDeduct">Ø³Ù†ÙˆÙŠØ© (Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯)</option>
                            <option data-i18n="emergency">Ø§Ø¶Ø·Ø±Ø§Ø±ÙŠØ©</option>
                        </select>
                    </div>
                </div>

                <div id="letterFields" class="hidden">
                    <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 mb-1" data-i18n="modEntity">Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…ÙˆØ¬Ù‡ Ø¥Ù„ÙŠÙ‡Ø§</label>
                    <input type="text" class="w-full bg-white dark:bg-slate-900 border dark:border-slate-600 rounded-lg p-2 text-sm dark:text-white" placeholder="...">
                </div>

                <div>
                    <label class="block text-xs font-bold text-slate-500 dark:text-slate-400 mb-1" data-i18n="modNotes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
                    <textarea class="w-full bg-white dark:bg-slate-900 border dark:border-slate-600 rounded-lg p-2 text-sm h-20 dark:text-white"></textarea>
                </div>
            </div>

            <div class="mt-6 flex justify-end gap-3 pt-4 border-t dark:border-slate-700">
                <button onclick="document.getElementById('requestModal').classList.add('hidden')" class="px-4 py-2 border rounded-lg text-xs font-bold hover:bg-slate-50 dark:hover:bg-slate-700 dark:text-white transition" data-i18n="btnCancel">Ø¥Ù„ØºØ§Ø¡</button>
                <button onclick="submitRequest()" class="px-6 py-2 bg-brandRed text-white rounded-lg text-xs font-bold hover:bg-red-700 shadow-md hover:shadow-lg transition" data-i18n="btnSend">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="data/company_policy.js"></script>
    <script src="js/core/config.js"></script>
    <script src="js/core/i18n.js"></script>
    <script src="js/helpers/policy-helpers.js"></script>
    <script src="js/services/data-service.js"></script>
    <script src="js/components/layout.js"></script>
    <script src="js/components/bot.js"></script>

    <script>
        // ==========================================
        // TRANSLATION DICTIONARY
        // ==========================================
        const translations = {
            ar: {
                pageTitle: "Ù…Ù„ÙÙŠ Ø§Ù„Ø´Ø®ØµÙŠ | AndroGov",
                loading: "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ...",
                reqLeave: "Ø·Ù„Ø¨ Ø¥Ø¬Ø§Ø²Ø©",
                reqLetter: "ØªØ¹Ø±ÙŠÙ Ø±Ø§ØªØ¨",
                leaveBal: "Ø±ØµÙŠØ¯ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø§Øª",
                annual: "Ø³Ù†ÙˆÙŠØ©",
                emergency: "Ø§Ø¶Ø·Ø±Ø§Ø±ÙŠØ©",
                days: "ÙŠÙˆÙ…",
                ticketEnt: "Ø§Ø³ØªØ­Ù‚Ø§Ù‚ Ø§Ù„ØªØ°Ø§ÙƒØ±",
                eligible: "Ù…Ø³ØªØ­Ù‚ (Ø¹Ø§Ø¦Ù„Ø©)",
                contractInfo: "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù‚Ø¯",
                joinDate: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©",
                contractType: "Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù‚Ø¯",
                unlimited: "ØºÙŠØ± Ù…Ø­Ø¯Ø¯ Ø§Ù„Ù…Ø¯Ø©",
                manager: "Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¨Ø§Ø´Ø±",
                location: "Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…Ù„",
                hq: "Ø§Ù„Ù…Ù‚Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ - Ø§Ù„Ø±ÙŠØ§Ø¶",
                financialData: "Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ©",
                confidential: "Ø®Ø§Øµ ÙˆØ³Ø±ÙŠ",
                basicSalary: "Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ",
                housing: "Ø¨Ø¯Ù„ Ø³ÙƒÙ†",
                transport: "Ø¨Ø¯Ù„ Ù†Ù‚Ù„",
                bonus: "Ù…ÙƒØ§ÙØ¦Ø© Ø´Ù‡Ø±ÙŠØ©",
                netSalary: "ØµØ§ÙÙŠ Ø§Ù„Ø±Ø§ØªØ¨",
                hoverReveal: "Ø¶Ø¹ Ø§Ù„Ù…Ø¤Ø´Ø± Ù„Ù„ÙƒØ´Ù",
                prevReq: "Ø·Ù„Ø¨Ø§ØªÙŠ Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©",
                viewAll: "Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„",
                colReqNo: "Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨",
                colType: "Ø§Ù„Ù†ÙˆØ¹",
                colDate: "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨",
                colApp: "Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø§Øª",
                colStatus: "Ø§Ù„Ø­Ø§Ù„Ø©",
                leave5days: "Ø¥Ø¬Ø§Ø²Ø© Ø³Ù†ÙˆÙŠØ© (5 Ø£ÙŠØ§Ù…)",
                approved: "Ù…Ø¹ØªÙ…Ø¯",
                letterReq: "Ø®Ø·Ø§Ø¨ ØªØ¹Ø±ÙŠÙ (Ø¨Ù†Ùƒ Ø§Ù„Ø±Ø§Ø¬Ø­ÙŠ)",
                pending: "ØªØ­Øª Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡",
                attendance: "Ø³Ø¬Ù„ Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ø§Ù†ØµØ±Ø§Ù (Ø£Ø³Ø¨ÙˆØ¹ÙŠ)",
                discipline: "Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ù†Ø¶Ø¨Ø§Ø·: 98%",
                daysWeek: ["Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø§Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³"],
                modTitle: "Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯",
                modType: "Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨",
                modFrom: "Ù…Ù† ØªØ§Ø±ÙŠØ®",
                modTo: "Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®",
                modLeaveType: "Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¬Ø§Ø²Ø©",
                annualDeduct: "Ø³Ù†ÙˆÙŠØ© (Ø®ØµÙ… Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯)",
                modEntity: "Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…ÙˆØ¬Ù‡ Ø¥Ù„ÙŠÙ‡Ø§",
                modNotes: "Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©",
                btnCancel: "Ø¥Ù„ØºØ§Ø¡",
                btnSend: "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨",
                ceoName: "Ù‡Ø´Ø§Ù… Ø§Ù„Ø³Ø­ÙŠØ¨Ø§Ù†ÙŠ (CEO)",
                reqSuccess: "ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­"
            },
            en: {
                pageTitle: "My Profile | AndroGov",
                loading: "Loading profile...",
                reqLeave: "Leave Request",
                reqLetter: "Salary Letter",
                leaveBal: "Leave Balance",
                annual: "Annual",
                emergency: "Emergency",
                days: "Days",
                ticketEnt: "Ticket Entitlement",
                eligible: "Eligible (Family)",
                contractInfo: "Contract Info",
                joinDate: "Joining Date",
                contractType: "Contract Type",
                unlimited: "Unlimited",
                manager: "Direct Manager",
                location: "Work Location",
                hq: "HQ - Riyadh",
                financialData: "Financial Data",
                confidential: "Confidential",
                basicSalary: "Basic Salary",
                housing: "Housing",
                transport: "Transport",
                bonus: "Monthly Bonus",
                netSalary: "Net Salary",
                hoverReveal: "Hover to reveal",
                prevReq: "Previous Requests",
                viewAll: "View All",
                colReqNo: "Req No",
                colType: "Type",
                colDate: "Date",
                colApp: "Approvals",
                colStatus: "Status",
                leave5days: "Annual Leave (5 Days)",
                approved: "Approved",
                letterReq: "Salary Letter (AlRajhi Bank)",
                pending: "Pending",
                attendance: "Attendance Record (Weekly)",
                discipline: "Discipline: 98%",
                daysWeek: ["Sun", "Mon", "Tue", "Wed", "Thu"],
                modTitle: "New Request",
                modType: "Request Type",
                modFrom: "From Date",
                modTo: "To Date",
                modLeaveType: "Leave Type",
                annualDeduct: "Annual (Deducted from Balance)",
                modEntity: "Directed To",
                modNotes: "Additional Notes",
                btnCancel: "Cancel",
                btnSend: "Send Request",
                ceoName: "Hesham Al-Suhaibani (CEO)",
                reqSuccess: "Request submitted successfully"
            }
        };

        // ==========================================
        // INITIALIZATION
        // ==========================================
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ Profile page - DOM loaded');
            
            // âœ… Set initial language
            const initialLang = localStorage.getItem('lang') || 'ar';
            document.documentElement.lang = initialLang;
            document.documentElement.dir = initialLang === 'ar' ? 'rtl' : 'ltr';
            
            // âœ… Set initial margin
            const mainContent = document.querySelector('.main-content-wrapper');
            if (mainContent) {
                if (initialLang === 'ar') {
                    mainContent.classList.remove('md:ml-72');
                    mainContent.classList.add('md:mr-72');
                } else {
                    mainContent.classList.remove('md:mr-72');
                    mainContent.classList.add('md:ml-72');
                }
            }
            
            // Wait for dependencies
            const checkSystem = setInterval(() => {
                if (typeof Layout !== 'undefined' && typeof AppConfig !== 'undefined' && typeof DataService !== 'undefined') {
                    clearInterval(checkSystem);
                    
                    // Auto-login
                    if (!AppConfig.getCurrentUser()) {
                        const defaultUser = DataService.getUserById('USR_004') || DataService.getUsers()[0];
                        if (defaultUser) {
                            AppConfig.setCurrentUser(defaultUser);
                        }
                    }

                    // Initialize
                    Layout.init();
                    
                    setTimeout(() => {
                        initPage();
                        hideLoading();
                    }, 300);
                }
            }, 50);
            
            // âœ… Listen for language changes
            window.addEventListener('languageChanged', (e) => {
                console.log('ğŸŒ Language changed to:', e.detail.lang);
                updatePageLanguage();
            });
        });

        function hideLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.classList.add('hidden');
            }
        }

        // ==========================================
        // PAGE FUNCTIONS
        // ==========================================
        function initPage() {
            updatePageLanguage();
            loadUserData();
        }

        function loadUserData() {
            let user = AppConfig.getCurrentUser();
            
            // Refresh user data
            if (user && user.id && typeof DataService !== 'undefined') {
                const freshUser = DataService.getUserById(user.id);
                if (freshUser) {
                    user = freshUser;
                    AppConfig.setCurrentUser(user);
                }
            }

            if (user) {
                // Profile Header
                document.getElementById('profName').innerText = user.displayName || '---';
                document.getElementById('profRole').innerText = user.displayTitle || '---';
                
                // Fix avatar path
                let avatarPath = user.avatar || '';
                if (avatarPath && !avatarPath.startsWith('http') && !avatarPath.startsWith('../')) {
                    avatarPath = '../' + avatarPath;
                }
                document.getElementById('profAvatar').src = avatarPath || 
                    'https://ui-avatars.com/api/?name=' + encodeURIComponent(user.displayName || 'User') + '&background=DC2626&color=fff';
                
                document.getElementById('profId').innerText = user.id || '---';
                document.getElementById('profEmail').innerText = user.email || '---';
                document.getElementById('profDept').innerText = user.displayDept || '---';
            }
        }

        function updatePageLanguage() {
            const lang = localStorage.getItem('lang') || 'ar';
            const dict = translations[lang];
            
            // Update HTML attributes
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            
            // Update main content margin
            const mainContent = document.querySelector('.main-content-wrapper');
            if (mainContent) {
                if (lang === 'ar') {
                    mainContent.classList.remove('md:ml-72');
                    mainContent.classList.add('md:mr-72');
                } else {
                    mainContent.classList.remove('md:mr-72');
                    mainContent.classList.add('md:ml-72');
                }
            }

            // Update page title
            document.title = dict.pageTitle;
            
            // Translate all elements
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (dict[key]) el.innerText = dict[key];
            });

            // Update attendance grid
            renderAttendance(lang);
            
            console.log(`âœ… Profile page updated to: ${lang}`);
        }

        function renderAttendance(lang) {
            const container = document.getElementById('attendanceGrid');
            const days = translations[lang].daysWeek;
            
            // Static demo data
            const times = [
                { in: '07:55', out: '16:05', c: 'green' },
                { in: '08:00', out: '16:00', c: 'green' },
                { in: '08:15', out: '16:10', c: 'red' },
                { in: '07:50', out: '16:00', c: 'green' },
                { in: '07:58', out: '15:55', c: 'green' }
            ];

            container.innerHTML = days.map((day, i) => `
                <div class="p-2 bg-slate-50 dark:bg-slate-700 rounded-xl ${times[i].c === 'red' ? 'border border-red-200 dark:border-red-800' : ''} hover:scale-105 transition-transform">
                    <p class="text-[10px] text-slate-400 mb-1">${day}</p>
                    <p class="text-xs font-bold text-${times[i].c === 'green' ? 'green-600 dark:text-green-400' : 'red-500 dark:text-red-400'} mb-1">${times[i].in}</p>
                    <p class="text-xs font-bold text-slate-600 dark:text-slate-300">${times[i].out}</p>
                </div>
            `).join('');
        }

        function openRequestModal(type) {
            const modal = document.getElementById('requestModal');
            const title = document.getElementById('reqModalTitle');
            const typeInput = document.getElementById('reqType');
            const leaveFields = document.getElementById('leaveFields');
            const letterFields = document.getElementById('letterFields');
            const lang = localStorage.getItem('lang') || 'ar';
            const dict = translations[lang];

            modal.classList.remove('hidden');

            if (type === 'leave') {
                title.innerText = dict.reqLeave;
                typeInput.value = dict.reqLeave;
                leaveFields.classList.remove('hidden');
                letterFields.classList.add('hidden');
            } else {
                title.innerText = dict.reqLetter;
                typeInput.value = dict.reqLetter;
                leaveFields.classList.add('hidden');
                letterFields.classList.remove('hidden');
            }
        }

        function submitRequest() {
            const lang = localStorage.getItem('lang') || 'ar';
            const dict = translations[lang];
            
            alert(dict.reqSuccess);
            document.getElementById('requestModal').classList.add('hidden');
        }

        // âœ… Expose for Layout to call
        window.updateProfileContent = updatePageLanguage;
    </script>
</body>
</html>
